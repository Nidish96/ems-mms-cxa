<!DOCTYPE html>
<html>
 <head>
  <title>b0_MMS-EMS-rect_linear</title>
  <meta name="generator" content="wxMaxima">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    displayAlign: "left",
    context: "MathJax",
    TeX: {TagSide: "left"}
  })
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  // A comment that hinders wxWidgets from optimizing this tag too much.
</script>
  <link rel="stylesheet" type="text/css" href="b0_MMS-EMS-rect_linear_htmlimg/b0_MMS-EMS-rect_linear.css">
 </head>
 <body>

<!-- ************************************************************************** -->
<!-- *        Created with wxMaxima version 24.02.2_DevelopmentSnapshot       * -->
<!-- ************************************************************************** -->
<noscript><div class="error message"><p>Please enable JavaScript in order to get a 2d display of the equations embedded in this web page.</p></div></noscript><p hidden = "hidden">\(      \DeclareMathOperator{\abs}{abs}
      \newcommand{\ensuremath}[1]{\mbox{$#1$}}
\)</p>

<!-- Text cell -->


<div class="comment">
In this worksheet we shall derive the MMS and EMS equations (you can choose the method below) for a linear system. The sheet contains MoR expansions until O(ε²) but the setup is sufficiently generic to allow for more.
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">kill</span><span class="code_operator">(</span><span class="code_variable">all</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">derivabbrev</span><span class="code_operator">:</span><span class="code_function">true</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">derivsubst</span><span class="code_operator">:</span><span class="code_function">true</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_endofline"><br>
</span><span class="code_variable">n</span><span class="code_operator">:</span><span class="code_number">3</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">Ts</span><span class="code_operator">:</span><span class="code_function">makelist</span><span class="code_operator">(</span><span class="code_function">concat</span><span class="code_operator">(</span><span class="code_variable">T</span><span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">i</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_variable">n</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">Ts1</span><span class="code_operator">:</span><span class="code_function">makelist</span><span class="code_operator">(</span><span class="code_function">concat</span><span class="code_operator">(</span><span class="code_variable">T</span><span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">i</span><span class="code_endofline">,</span> <span class="code_number">1</span><span class="code_endofline">,</span> <span class="code_variable">n</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_function">depends</span><span class="code_operator">(</span><span class="code_function">makelist</span><span class="code_operator">(</span><span class="code_function">concat</span><span class="code_operator">(</span><span class="code_variable">x</span><span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">i</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_variable">n</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">Ts</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_function">depends</span><span class="code_operator">(</span><span class="code_function">makelist</span><span class="code_operator">(</span><span class="code_function">concat</span><span class="code_operator">(</span><span class="code_variable">A</span><span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">i</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_variable">n</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">Ts1</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_function">depends</span><span class="code_operator">(</span><span class="code_function">makelist</span><span class="code_operator">(</span><span class="code_function">concat</span><span class="code_operator">(</span><span class="code_variable">B</span><span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">i</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_variable">n</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">Ts1</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_endofline"><br>
</span><span class="code_variable">x</span><span class="code_operator">:</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_function">concat</span><span class="code_operator">(</span><span class="code_variable">x</span><span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">ε</span><span class="code_operator">·</span><span class="code_operator">·</span><span class="code_variable">i</span><span class="code_endofline">,</span> <span class="code_variable">i</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_variable">n</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_endofline"><br>
</span><span class="code_function">for</span> <span class="code_variable">i</span><span class="code_operator">:</span><span class="code_number">0</span> <span class="code_function">thru</span> <span class="code_variable">n</span> <span class="code_function">do</span><span class="code_operator">(</span><span class="code_function">eval_string</span><span class="code_operator">(</span><span class="code_function">concat</span><span class="code_operator">(</span><span class="code_string">&quot;gradef(T&quot;</span><span class="code_endofline">,</span> <span class="code_variable">i</span><span class="code_endofline">,</span> <span class="code_string">&quot;,t,ε**&quot;</span><span class="code_endofline">,</span> <span class="code_variable">i</span><span class="code_endofline">,</span> <span class="code_string">&quot;)&quot;</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{%o10} \ensuremath{\mathrm{done}}\]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">meth</span><span class="code_operator">:</span><span class="code_string">&quot;EMS&quot;</span><span class="code_endofline">$</span>  <span class="code_comment">/* Choose &quot;MMS&quot; or &quot;EMS&quot; */</span>  </span></td>
</tr></table>



<!-- Section cell -->


<div class="section">
<p>
  1 Choose Formulation (Comment one of the following out to get results for the other)
</p>
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">assume</span><span class="code_operator">(</span><span class="code_variable">Ω</span><span class="code_endofline">&gt;</span><span class="code_number">0</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_function">assume</span><span class="code_operator">(</span><span class="code_variable">ω0</span><span class="code_endofline">&gt;</span><span class="code_number">0</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_function">if</span> <span class="code_variable">meth</span><span class="code_operator">=</span><span class="code_string">&quot;MMS&quot;</span><span class="code_endofline"><br>
</span>    <span class="code_function">then</span> <span class="code_function">block</span><span class="code_operator">(</span><span class="code_variable">σ</span><span class="code_operator">:</span><span class="code_function">sum</span><span class="code_operator">(</span><span class="code_function">concat</span><span class="code_operator">(</span><span class="code_variable">ω</span><span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_function">concat</span><span class="code_operator">(</span><span class="code_variable">T</span><span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">i</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_variable">n</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_function">eom</span><span class="code_operator">(</span><span class="code_variable">X</span><span class="code_operator">)</span><span class="code_operator">:</span><span class="code_operator">=</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">X</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_endofline">,</span><span class="code_number">2</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">ε</span><span class="code_operator">·</span><span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">ζ</span><span class="code_operator">·</span><span class="code_variable">ω0</span><span class="code_operator">·</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">X</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">ω0</span><span class="code_operator">·</span><span class="code_operator">·</span><span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">X</span> <span class="code_operator">−</span> <span class="code_variable">ε</span><span class="code_operator">·</span><span class="code_variable">F</span><span class="code_operator">·</span><span class="code_function">cos</span><span class="code_operator">(</span><span class="code_variable">σ</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_function">disp</span><span class="code_operator">(</span><span class="code_string">&quot;Choosing MMS&quot;</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline"><br>
</span>    <span class="code_function">else</span> <span class="code_function">block</span><span class="code_operator">(</span><span class="code_variable">σ</span><span class="code_operator">:</span><span class="code_variable">Ω</span><span class="code_operator">·</span><span class="code_variable">T0</span><span class="code_endofline">,</span> <span class="code_function">eom</span><span class="code_operator">(</span><span class="code_variable">X</span><span class="code_operator">)</span><span class="code_operator">:</span><span class="code_operator">=</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">X</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_endofline">,</span><span class="code_number">2</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">ε</span><span class="code_operator">·</span><span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">ζ</span><span class="code_operator">·</span><span class="code_variable">ω0</span><span class="code_operator">·</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_variable">X</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span> <span class="code_operator">+</span> <span class="code_variable">Ω</span><span class="code_operator">·</span><span class="code_operator">·</span><span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">X</span> <span class="code_operator">+</span> <span class="code_variable">ε</span><span class="code_operator">·</span><span class="code_operator">(</span><span class="code_variable">ω0</span><span class="code_operator">·</span><span class="code_operator">·</span><span class="code_number">2</span><span class="code_operator">−</span><span class="code_variable">Ω</span><span class="code_operator">·</span><span class="code_operator">·</span><span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">X</span><span class="code_operator">−</span> <span class="code_variable">ε</span><span class="code_operator">·</span><span class="code_variable">F</span><span class="code_operator">·</span><span class="code_function">cos</span><span class="code_operator">(</span><span class="code_variable">σ</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_function">disp</span><span class="code_operator">(</span><span class="code_string">&quot;Choosing EMS&quot;</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span>  </span></td>
</tr></table>
<p>
\[\]\[\mbox{}\\"Choosing EMS"\]
</p>


<!-- Section cell -->


<div class="section">
<p>
  2 Ordered Equations
</p>
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">for</span> <span class="code_variable">i</span><span class="code_operator">:</span><span class="code_number">0</span> <span class="code_function">thru</span> <span class="code_variable">n</span> <span class="code_function">do</span><span class="code_operator">(</span><span class="code_function">eval_string</span><span class="code_operator">(</span><span class="code_function">concat</span><span class="code_operator">(</span><span class="code_string">&quot;eom&quot;</span><span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_endofline">,</span><span class="code_string">&quot;:coeff(eom(x),ε,&quot;</span><span class="code_endofline">,</span><span class="code_variable">i</span><span class="code_endofline">,</span><span class="code_string">&quot;);&quot;</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">;</span>  <span class="code_comment">/* eom0, eom1, ... are the ordered equations of motion */</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{%o15} \ensuremath{\mathrm{done}}\]
</p>


<!-- Subsection cell -->


<div class="subsect">
<p>
  2.1 O(1), Zeroth Order
</p>
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O0sol</span><span class="code_operator">:</span><span class="code_variable">x0</span><span class="code_operator">=</span><span class="code_variable">A0</span><span class="code_operator">·</span><span class="code_function">cos</span><span class="code_operator">(</span><span class="code_variable">σ</span><span class="code_operator">)</span><span class="code_operator">+</span><span class="code_variable">B0</span><span class="code_operator">·</span><span class="code_function">sin</span><span class="code_operator">(</span><span class="code_variable">σ</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{0so} \ensuremath{\mathrm{x0}}\mathop{=}\ensuremath{\mathrm{B0}} \sin{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\mathop{+}\ensuremath{\mathrm{A0}} \cos{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\]
</p>


<!-- Subsection cell -->


<div class="subsect">
<p>
  2.2 O(ε), First Order
</p>
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O1eom</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O0sol</span><span class="code_endofline">,</span> <span class="code_variable">eom1</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O1eom</span><span class="code_operator">:</span><span class="code_function">ev</span><span class="code_operator">(</span><span class="code_variable">O1eom</span><span class="code_endofline">,</span><span class="code_variable">nouns</span><span class="code_operator">)</span><span class="code_endofline">;</span><span class="code_endofline"><br>
</span><span class="code_variable">O1rhs</span><span class="code_operator">:</span><span class="code_operator">−</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">x1</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">O1eom</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O1lhs</span><span class="code_operator">:</span><span class="code_variable">O1eom</span><span class="code_operator">+</span><span class="code_variable">O1rhs</span><span class="code_endofline">$</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{1eo} \left( \ensuremath{\mathrm{B0}} \sin{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\mathop{+}\ensuremath{\mathrm{A0}} \cos{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\right)  {{\ensuremath{\mathrm{\omega 0}}}^{2}}\mathop{+}2 \left( \ensuremath{\mathrm{B0}} \Omega  \cos{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\mathop{-}\ensuremath{\mathrm{A0}} \Omega  \sin{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\right)  \zeta \, \ensuremath{\mathrm{\omega 0}}\mathop{+}2 \left( \left( {{\ensuremath{\mathrm{B0}}}_{\ensuremath{\mathrm{T1}}}}\right)  \Omega  \cos{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\mathop{-}\left( {{\ensuremath{\mathrm{A0}}}_{\ensuremath{\mathrm{T1}}}}\right)  \Omega  \sin{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\right) \mathop{-}{{\Omega }^{2}} \left( \ensuremath{\mathrm{B0}} \sin{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\mathop{+}\ensuremath{\mathrm{A0}} \cos{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\right) \mathop{-}F \cos{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\mathop{+}\ensuremath{\mathrm{x1}} {{\Omega }^{2}}\mathop{+}{{\ensuremath{\mathrm{x1}}}_{\ensuremath{\mathrm{T0}}\ensuremath{\mathrm{T0}}}}\]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">if</span> <span class="code_variable">meth</span><span class="code_operator">=</span><span class="code_string">&quot;MMS&quot;</span><span class="code_endofline"><br>
</span>    <span class="code_function">then</span> <span class="code_variable">O1H1</span><span class="code_operator">:</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">O1rhs</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω0</span><span class="code_operator">·</span><span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">%pi</span><span class="code_operator">/</span><span class="code_variable">ω0</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">ω0</span><span class="code_operator">/</span><span class="code_variable">%pi</span><span class="code_operator">)</span><span class="code_endofline"><br>
</span>    <span class="code_function">else</span> <span class="code_variable">O1H1</span><span class="code_operator">:</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">O1rhs</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">Ω</span><span class="code_operator">·</span><span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">%pi</span><span class="code_operator">/</span><span class="code_variable">Ω</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">Ω</span><span class="code_operator">/</span><span class="code_variable">%pi</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O1st</span><span class="code_operator">:</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_function">trigreduce</span><span class="code_operator">(</span><span class="code_function">solve</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_function">realpart</span><span class="code_operator">(</span><span class="code_variable">O1H1</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_function">imagpart</span><span class="code_operator">(</span><span class="code_variable">O1H1</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">T1</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">[</span><span class="code_number">1</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{1s} \left[ {{\ensuremath{\mathrm{A0}}}_{\ensuremath{\mathrm{T1}}}}\mathop{=}\frac{\ensuremath{\mathrm{B0}} {{\ensuremath{\mathrm{\omega 0}}}^{2}}}{2 \Omega }\mathop{-}\ensuremath{\mathrm{A0}} \zeta \, \ensuremath{\mathrm{\omega 0}}\mathop{-}\frac{\ensuremath{\mathrm{B0}} \Omega }{2}\mathop{,}{{\ensuremath{\mathrm{B0}}}_{\ensuremath{\mathrm{T1}}}}\mathop{=}\mathop{-}\left( \frac{\ensuremath{\mathrm{A0}} {{\ensuremath{\mathrm{\omega 0}}}^{2}}}{2 \Omega }\right) \mathop{-}\ensuremath{\mathrm{B0}} \zeta \, \ensuremath{\mathrm{\omega 0}}\mathop{+}\frac{\ensuremath{\mathrm{A0}} \Omega }{2}\mathop{+}\frac{F}{2 \Omega }\right] \]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">J0</span><span class="code_operator">:</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">jacobian</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O1st</span><span class="code_endofline">,</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">T1</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">;</span><span class="code_endofline"><br>
</span><span class="code_variable">F0</span><span class="code_operator">:</span><span class="code_function">map</span><span class="code_operator">(</span><span class="code_variable">rhs</span><span class="code_endofline">,</span> <span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">O1st</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{} \begin{pmatrix}\mathop{-}\left( \zeta \, \ensuremath{\mathrm{\omega 0}}\right)  &amp; \frac{\left( \ensuremath{\mathrm{\omega 0}}\mathop{-}\Omega \right) \, \left( \ensuremath{\mathrm{\omega 0}}\mathop{+}\Omega \right) }{2 \Omega }\\
\mathop{-}\left( \frac{\left( \ensuremath{\mathrm{\omega 0}}\mathop{-}\Omega \right) \, \left( \ensuremath{\mathrm{\omega 0}}\mathop{+}\Omega \right) }{2 \Omega }\right)  &amp; \mathop{-}\left( \zeta \, \ensuremath{\mathrm{\omega 0}}\right) \end{pmatrix}\]
</p>
<p>
\[\]\[\tag{} \left[ 0\mathop{,}\frac{F}{2 \Omega }\right] \]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O1sol</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">%k1</span><span class="code_operator">=</span><span class="code_variable">B1</span><span class="code_endofline">,</span><span class="code_variable">%k2</span><span class="code_operator">=</span><span class="code_variable">A1</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">ode2</span><span class="code_operator">(</span><span class="code_variable">O1lhs</span><span class="code_operator">−</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_function">exponentialize</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O1st</span><span class="code_endofline">,</span><span class="code_variable">O1rhs</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">x1</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O1sol</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A1</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">B1</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">O1sol</span><span class="code_operator">)</span><span class="code_endofline">$</span> <span class="code_comment">/* We set this to zero for the Method of Reconstitution */</span>  </span></td>
</tr></table>
<p>
\[\]\[(\% i1) 
\]\[(\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) (\% i1) \]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O01sol</span><span class="code_operator">:</span><span class="code_function">append</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">O0sol</span><span class="code_endofline">,</span><span class="code_variable">O1sol</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">O1st</span><span class="code_operator">)</span><span class="code_endofline">;</span><span class="code_endofline"><br>
</span><span class="code_variable">O01sol_</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">O0sol</span><span class="code_endofline">,</span><span class="code_variable">O1sol</span><span class="code_operator">]</span><span class="code_endofline">$</span>   </span></td>
</tr></table>
<p>
\[\]\[\tag{01so} \]
</p>


<!-- Subsection cell -->


<div class="subsect">
<p>
  2.3 O(ε^2), Second Order
</p>
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O2eom</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O01sol</span><span class="code_endofline">,</span> <span class="code_variable">eom2</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O2eom</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O01sol</span><span class="code_endofline">,</span><span class="code_function">ev</span><span class="code_operator">(</span><span class="code_variable">O2eom</span><span class="code_endofline">,</span><span class="code_variable">nouns</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O2eom</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O01sol</span><span class="code_endofline">,</span><span class="code_function">ev</span><span class="code_operator">(</span><span class="code_variable">O2eom</span><span class="code_endofline">,</span><span class="code_variable">nouns</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O2eom</span><span class="code_operator">:</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">exponentialize</span><span class="code_operator">(</span><span class="code_function">ev</span><span class="code_operator">(</span><span class="code_variable">O2eom</span><span class="code_endofline">,</span><span class="code_variable">nouns</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O2rhs</span><span class="code_operator">:</span><span class="code_operator">−</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">x2</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">O2eom</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O2lhs</span><span class="code_operator">:</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_variable">O2eom</span><span class="code_operator">+</span><span class="code_variable">O2rhs</span><span class="code_operator">)</span><span class="code_endofline">$</span>  </span></td>
</tr></table>



<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">if</span> <span class="code_variable">meth</span><span class="code_operator">=</span><span class="code_string">&quot;MMS&quot;</span><span class="code_endofline"><br>
</span>    <span class="code_function">then</span> <span class="code_variable">O2H1</span><span class="code_operator">:</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">O2rhs</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω0</span><span class="code_operator">·</span><span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">%pi</span><span class="code_operator">/</span><span class="code_variable">ω0</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">ω0</span><span class="code_operator">/</span><span class="code_variable">%pi</span><span class="code_operator">)</span><span class="code_endofline"><br>
</span>    <span class="code_function">else</span> <span class="code_variable">O2H1</span><span class="code_operator">:</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">O2rhs</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">Ω</span><span class="code_operator">·</span><span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">%pi</span><span class="code_operator">/</span><span class="code_variable">Ω</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">Ω</span><span class="code_operator">/</span><span class="code_variable">%pi</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O2st</span><span class="code_operator">:</span><span class="code_function">trigreduce</span><span class="code_operator">(</span><span class="code_function">solve</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_function">realpart</span><span class="code_operator">(</span><span class="code_variable">O2H1</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_function">imagpart</span><span class="code_operator">(</span><span class="code_variable">O2H1</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">T2</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">[</span><span class="code_number">1</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{2s} \]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">J1</span><span class="code_operator">:</span><span class="code_function">jacobian</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O2st</span><span class="code_endofline">,</span> <span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">T2</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">;</span><span class="code_endofline"><br>
</span><span class="code_variable">F1</span><span class="code_operator">:</span><span class="code_function">map</span><span class="code_operator">(</span><span class="code_variable">rhs</span><span class="code_endofline">,</span> <span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">O2st</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{} \begin{pmatrix}0 &amp; \frac{\mathop{-}{{\ensuremath{\mathrm{\omega 0}}}^{4}}\mathop{+}{{\Omega }^{2}} \left( 2\mathop{-}4 {{\zeta }^{2}}\right)  {{\ensuremath{\mathrm{\omega 0}}}^{2}}\mathop{-}{{\Omega }^{4}}}{8 {{\Omega }^{3}}}\\
\frac{{{\ensuremath{\mathrm{\omega 0}}}^{4}}\mathop{+}{{\Omega }^{2}} \left( 4 {{\zeta }^{2}}\mathop{-}2\right)  {{\ensuremath{\mathrm{\omega 0}}}^{2}}\mathop{+}{{\Omega }^{4}}}{8 {{\Omega }^{3}}} &amp; 0\end{pmatrix}\]
</p>
<p>
\[\]\[\tag{} \left[ \frac{F \zeta \, \ensuremath{\mathrm{\omega 0}}}{4 {{\Omega }^{2}}}\mathop{,}\frac{F {{\Omega }^{2}}\mathop{-}F {{\ensuremath{\mathrm{\omega 0}}}^{2}}}{8 {{\Omega }^{3}}}\right] \]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O2sol</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">%k2</span><span class="code_operator">=</span><span class="code_variable">A2</span><span class="code_endofline">,</span><span class="code_variable">%k1</span><span class="code_operator">=</span><span class="code_variable">B2</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">ode2</span><span class="code_operator">(</span><span class="code_variable">O2lhs</span><span class="code_operator">−</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_function">exponentialize</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O2st</span><span class="code_endofline">,</span> <span class="code_variable">O2rhs</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">x2</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O2sol</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A2</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">B2</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">O2sol</span><span class="code_operator">)</span><span class="code_endofline">$</span> <span class="code_comment">/* We set this to zero for the Method of Reconstitution */</span>  </span></td>
</tr></table>



<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O012sol</span><span class="code_operator">:</span><span class="code_function">append</span><span class="code_operator">(</span><span class="code_variable">O01sol</span><span class="code_endofline">,</span><span class="code_variable">O2st</span><span class="code_endofline">,</span><span class="code_operator">[</span><span class="code_variable">O2sol</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{012so} \]
</p>


<!-- Subsubsection cell -->


<div class="subsubsect">
<p>
  2.3.1 Incomplete Method
</p>
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O2eom</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O01sol_</span><span class="code_endofline">,</span> <span class="code_variable">eom2</span><span class="code_operator">)</span><span class="code_endofline">$</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{%o66} 2 \left( \left( {{\ensuremath{\mathrm{B0}}}_{\ensuremath{\mathrm{T1}}}}\right)  \sin{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\mathop{+}\left( {{\ensuremath{\mathrm{A0}}}_{\ensuremath{\mathrm{T1}}}}\right)  \cos{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\right)  \zeta \, \ensuremath{\mathrm{\omega 0}}\mathop{+}2 \left( \left( {{\ensuremath{\mathrm{B0}}}_{\ensuremath{\mathrm{T2}}}}\right)  \Omega  \cos{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\mathop{-}\left( {{\ensuremath{\mathrm{A0}}}_{\ensuremath{\mathrm{T2}}}}\right)  \Omega  \sin{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\right) \mathop{+}\left( {{\ensuremath{\mathrm{B0}}}_{\ensuremath{\mathrm{T1}}\ensuremath{\mathrm{T1}}}}\right)  \sin{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\mathop{+}\left( {{\ensuremath{\mathrm{A0}}}_{\ensuremath{\mathrm{T1}}\ensuremath{\mathrm{T1}}}}\right)  \cos{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\mathop{+}\ensuremath{\mathrm{x2}} {{\Omega }^{2}}\mathop{+}{{\ensuremath{\mathrm{x2}}}_{\ensuremath{\mathrm{T0}}\ensuremath{\mathrm{T0}}}}\]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O2eom</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O01sol_</span><span class="code_endofline">,</span> <span class="code_variable">eom2</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O2eom</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">T1</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_function">ev</span><span class="code_operator">(</span><span class="code_variable">O2eom</span><span class="code_endofline">,</span> <span class="code_variable">nouns</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O2rhs</span><span class="code_operator">:</span><span class="code_operator">−</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">x2</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">O2eom</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O2lhs</span><span class="code_operator">:</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_variable">O2eom</span><span class="code_operator">+</span><span class="code_variable">O2rhs</span><span class="code_operator">)</span><span class="code_endofline">$</span>  </span></td>
</tr></table>



<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">if</span> <span class="code_variable">meth</span><span class="code_operator">=</span><span class="code_string">&quot;MMS&quot;</span><span class="code_endofline"><br>
</span>    <span class="code_function">then</span> <span class="code_variable">O2H1</span><span class="code_operator">:</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">O2rhs</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω0</span><span class="code_operator">·</span><span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">%pi</span><span class="code_operator">/</span><span class="code_variable">ω0</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">ω0</span><span class="code_operator">/</span><span class="code_variable">%pi</span><span class="code_operator">)</span><span class="code_endofline"><br>
</span>    <span class="code_function">else</span> <span class="code_variable">O2H1</span><span class="code_operator">:</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">O2rhs</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">Ω</span><span class="code_operator">·</span><span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">%pi</span><span class="code_operator">/</span><span class="code_variable">Ω</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">Ω</span><span class="code_operator">/</span><span class="code_variable">%pi</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O2st_</span><span class="code_operator">:</span><span class="code_function">trigreduce</span><span class="code_operator">(</span><span class="code_function">solve</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_function">realpart</span><span class="code_operator">(</span><span class="code_variable">O2H1</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_function">imagpart</span><span class="code_operator">(</span><span class="code_variable">O2H1</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">T2</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">[</span><span class="code_number">1</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{2st\} \left[ {{\ensuremath{\mathrm{A0}}}_{\ensuremath{\mathrm{T2}}}}\mathop{=}0\mathop{,}{{\ensuremath{\mathrm{B0}}}_{\ensuremath{\mathrm{T2}}}}\mathop{=}0\right] \]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">J1_</span><span class="code_operator">:</span><span class="code_function">jacobian</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O2st_</span><span class="code_endofline">,</span> <span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">T2</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">;</span><span class="code_endofline"><br>
</span><span class="code_variable">F1_</span><span class="code_operator">:</span><span class="code_function">map</span><span class="code_operator">(</span><span class="code_variable">rhs</span><span class="code_endofline">,</span> <span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">O2st_</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{1\} \begin{pmatrix}0 &amp; 0\\
0 &amp; 0\end{pmatrix}\]
</p>
<p>
\[\]\[\tag{1\} \left[ 0\mathop{,}0\right] \]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O2sol_</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">%k2</span><span class="code_operator">=</span><span class="code_variable">A2</span><span class="code_endofline">,</span><span class="code_variable">%k1</span><span class="code_operator">=</span><span class="code_variable">B2</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">ode2</span><span class="code_operator">(</span><span class="code_variable">O2lhs</span><span class="code_operator">−</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_function">exponentialize</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O2st_</span><span class="code_endofline">,</span> <span class="code_variable">O2rhs</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">x2</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O2sol_</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A2</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">B2</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">O2sol</span><span class="code_operator">)</span><span class="code_endofline">$</span> <span class="code_comment">/* We set this to zero for the Method of Reconstitution */</span>  </span></td>
</tr></table>



<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O012solinc</span><span class="code_operator">:</span><span class="code_function">append</span><span class="code_operator">(</span><span class="code_variable">O01sol_</span><span class="code_endofline">,</span><span class="code_variable">O2st_</span><span class="code_endofline">,</span><span class="code_operator">[</span><span class="code_variable">O2sol_</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O012solinc_</span><span class="code_operator">:</span><span class="code_function">append</span><span class="code_operator">(</span><span class="code_variable">O01sol_</span><span class="code_endofline">,</span><span class="code_operator">[</span><span class="code_variable">O2sol_</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{012solinc\} \left[ \ensuremath{\mathrm{x0}}\mathop{=}\ensuremath{\mathrm{B0}} \sin{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\mathop{+}\ensuremath{\mathrm{A0}} \cos{\left( \ensuremath{\mathrm{T0}} \Omega \right) }\mathop{,}\ensuremath{\mathrm{x1}}\mathop{=}0\mathop{,}\ensuremath{\mathrm{x2}}\mathop{=}0\right] \]
</p>


<!-- Subsection cell -->


<div class="subsect">
<p>
  2.4 O(ε^3), Third Order
</p>
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O3eom</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O012sol</span><span class="code_endofline">,</span><span class="code_variable">eom3</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O3eom</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O012sol</span><span class="code_endofline">,</span><span class="code_function">ev</span><span class="code_operator">(</span><span class="code_variable">O3eom</span><span class="code_endofline">,</span><span class="code_variable">nouns</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O3eom</span><span class="code_operator">:</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">exponentialize</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O012sol</span><span class="code_endofline">,</span><span class="code_function">ev</span><span class="code_operator">(</span><span class="code_variable">O3eom</span><span class="code_endofline">,</span><span class="code_variable">nouns</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O3rhs</span><span class="code_operator">:</span><span class="code_operator">−</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">x3</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">O3eom</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O3lhs</span><span class="code_operator">:</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_variable">O3eom</span><span class="code_operator">+</span><span class="code_variable">O3rhs</span><span class="code_operator">)</span><span class="code_endofline">$</span>  </span></td>
</tr></table>



<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">if</span> <span class="code_variable">meth</span><span class="code_operator">=</span><span class="code_string">&quot;MMS&quot;</span><span class="code_endofline"><br>
</span>    <span class="code_function">then</span> <span class="code_variable">O3H1</span><span class="code_operator">:</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">O3rhs</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω0</span><span class="code_operator">·</span><span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">%pi</span><span class="code_operator">/</span><span class="code_variable">ω0</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">ω0</span><span class="code_operator">/</span><span class="code_variable">%pi</span><span class="code_operator">)</span><span class="code_endofline"><br>
</span>    <span class="code_function">else</span> <span class="code_variable">O3H1</span><span class="code_operator">:</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">O3rhs</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">Ω</span><span class="code_operator">·</span><span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">%pi</span><span class="code_operator">/</span><span class="code_variable">Ω</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">Ω</span><span class="code_operator">/</span><span class="code_variable">%pi</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O3st</span><span class="code_operator">:</span><span class="code_function">trigreduce</span><span class="code_operator">(</span><span class="code_function">solve</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_function">realpart</span><span class="code_operator">(</span><span class="code_variable">O3H1</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_function">imagpart</span><span class="code_operator">(</span><span class="code_variable">O3H1</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">T3</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">[</span><span class="code_number">1</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{3s} \left[ {{\ensuremath{\mathrm{A0}}}_{\ensuremath{\mathrm{T3}}}}\mathop{=}\mathop{-}\left( \ensuremath{\mathrm{B0}}\, \ensuremath{\mathrm{\omega 3}}\right) \mathop{,}{{\ensuremath{\mathrm{B0}}}_{\ensuremath{\mathrm{T3}}}}\mathop{=}\frac{2 \ensuremath{\mathrm{A0}} {{\ensuremath{\mathrm{\omega 0}}}^{2}} \ensuremath{\mathrm{\omega 3}}\mathop{-}F\, \ensuremath{\mathrm{\omega 2}}}{2 {{\ensuremath{\mathrm{\omega 0}}}^{2}}}\right] \]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">J2</span><span class="code_operator">:</span><span class="code_function">jacobian</span><span class="code_operator">(</span><span class="code_function">map</span><span class="code_operator">(</span><span class="code_variable">rhs</span><span class="code_endofline">,</span> <span class="code_variable">O3st</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">;</span><span class="code_endofline"><br>
</span><span class="code_variable">F2</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">map</span><span class="code_operator">(</span><span class="code_variable">rhs</span><span class="code_endofline">,</span><span class="code_variable">O3st</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{} \begin{pmatrix}0 &amp; \mathop{-}\ensuremath{\mathrm{\omega 3}}\\
\ensuremath{\mathrm{\omega 3}} &amp; 0\end{pmatrix}\]
</p>
<p>
\[\]\[\tag{} \left[ 0\mathop{,}\mathop{-}\left( \frac{F\, \ensuremath{\mathrm{\omega 2}}}{2 {{\ensuremath{\mathrm{\omega 0}}}^{2}}}\right) \right] \]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O3sol</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">%k2</span><span class="code_operator">=</span><span class="code_variable">A3</span><span class="code_endofline">,</span><span class="code_variable">%k1</span><span class="code_operator">=</span><span class="code_variable">B3</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">ode2</span><span class="code_operator">(</span><span class="code_variable">O3lhs</span><span class="code_operator">−</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_function">exponentialize</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O3st</span><span class="code_endofline">,</span> <span class="code_variable">O3rhs</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">x3</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O3sol</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A3</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">B3</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">O3sol</span><span class="code_operator">)</span><span class="code_endofline">$</span> <span class="code_comment">/* We set this to zero for the Method of Reconstitution */</span>  </span></td>
</tr></table>



<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O0123sol</span><span class="code_operator">:</span><span class="code_function">append</span><span class="code_operator">(</span><span class="code_variable">O012sol</span><span class="code_endofline">,</span><span class="code_variable">O3st</span><span class="code_endofline">,</span><span class="code_operator">[</span><span class="code_variable">O3sol</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">$</span>  </span></td>
</tr></table>



<!-- Subsubsection cell -->


<div class="subsubsect">
<p>
  2.4.1 Incomplete Method
</p>
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O3eom</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O012solinc_</span><span class="code_endofline">,</span><span class="code_variable">eom3</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O3eom</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_function">append</span><span class="code_operator">(</span><span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">T1</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">T2</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_function">ev</span><span class="code_operator">(</span><span class="code_variable">O3eom</span><span class="code_endofline">,</span> <span class="code_variable">nouns</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O3rhs</span><span class="code_operator">:</span><span class="code_operator">−</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">x3</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">O3eom</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O3lhs</span><span class="code_operator">:</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_variable">O3eom</span><span class="code_operator">+</span><span class="code_variable">O3rhs</span><span class="code_operator">)</span><span class="code_endofline">$</span>  </span></td>
</tr></table>



<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">if</span> <span class="code_variable">meth</span><span class="code_operator">=</span><span class="code_string">&quot;MMS&quot;</span><span class="code_endofline"><br>
</span>    <span class="code_function">then</span> <span class="code_variable">O3H1</span><span class="code_operator">:</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">O3rhs</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">ω0</span><span class="code_operator">·</span><span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">%pi</span><span class="code_operator">/</span><span class="code_variable">ω0</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">ω0</span><span class="code_operator">/</span><span class="code_variable">%pi</span><span class="code_operator">)</span><span class="code_endofline"><br>
</span>    <span class="code_function">else</span> <span class="code_variable">O3H1</span><span class="code_operator">:</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">integrate</span><span class="code_operator">(</span><span class="code_variable">O3rhs</span><span class="code_operator">·</span><span class="code_function">exp</span><span class="code_operator">(</span><span class="code_operator">−</span><span class="code_variable">%i</span><span class="code_operator">·</span><span class="code_variable">Ω</span><span class="code_operator">·</span><span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_number">2</span><span class="code_operator">·</span><span class="code_variable">%pi</span><span class="code_operator">/</span><span class="code_variable">Ω</span><span class="code_operator">)</span><span class="code_operator">·</span><span class="code_variable">Ω</span><span class="code_operator">/</span><span class="code_variable">%pi</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O3st</span><span class="code_operator">:</span><span class="code_function">trigreduce</span><span class="code_operator">(</span><span class="code_function">solve</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_function">realpart</span><span class="code_operator">(</span><span class="code_variable">O3H1</span><span class="code_operator">)</span><span class="code_endofline">,</span><span class="code_function">imagpart</span><span class="code_operator">(</span><span class="code_variable">O3H1</span><span class="code_operator">)</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">T3</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">[</span><span class="code_number">1</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{3s} \left[ {{\ensuremath{\mathrm{A0}}}_{\ensuremath{\mathrm{T3}}}}\mathop{=}\mathop{-}\left( \ensuremath{\mathrm{B0}}\, \ensuremath{\mathrm{\omega 3}}\right) \mathop{-}\frac{\ensuremath{\mathrm{B0}}\, \ensuremath{\mathrm{\omega 1}}\, \ensuremath{\mathrm{\omega 2}}}{\ensuremath{\mathrm{\omega 0}}}\mathop{-}\ensuremath{\mathrm{A0}} \zeta \, \ensuremath{\mathrm{\omega 2}}\mathop{,}{{\ensuremath{\mathrm{B0}}}_{\ensuremath{\mathrm{T3}}}}\mathop{=}\ensuremath{\mathrm{A0}}\, \ensuremath{\mathrm{\omega 3}}\mathop{+}\frac{\ensuremath{\mathrm{A0}}\, \ensuremath{\mathrm{\omega 1}}\, \ensuremath{\mathrm{\omega 2}}}{\ensuremath{\mathrm{\omega 0}}}\mathop{-}\ensuremath{\mathrm{B0}} \zeta \, \ensuremath{\mathrm{\omega 2}}\right] \]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">J2</span><span class="code_operator">:</span><span class="code_function">jacobian</span><span class="code_operator">(</span><span class="code_function">map</span><span class="code_operator">(</span><span class="code_variable">rhs</span><span class="code_endofline">,</span> <span class="code_variable">O3st</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">;</span><span class="code_endofline"><br>
</span><span class="code_variable">F2</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">map</span><span class="code_operator">(</span><span class="code_variable">rhs</span><span class="code_endofline">,</span><span class="code_variable">O3st</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{} \begin{pmatrix}\mathop{-}\left( \zeta \, \ensuremath{\mathrm{\omega 2}}\right)  &amp; \mathop{-}\ensuremath{\mathrm{\omega 3}}\mathop{-}\frac{\ensuremath{\mathrm{\omega 1}}\, \ensuremath{\mathrm{\omega 2}}}{\ensuremath{\mathrm{\omega 0}}}\\
\ensuremath{\mathrm{\omega 3}}\mathop{+}\frac{\ensuremath{\mathrm{\omega 1}}\, \ensuremath{\mathrm{\omega 2}}}{\ensuremath{\mathrm{\omega 0}}} &amp; \mathop{-}\left( \zeta \, \ensuremath{\mathrm{\omega 2}}\right) \end{pmatrix}\]
</p>
<p>
\[\]\[\tag{} \left[ 0\mathop{,}0\right] \]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O3sol</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">%k2</span><span class="code_operator">=</span><span class="code_variable">A3</span><span class="code_endofline">,</span><span class="code_variable">%k1</span><span class="code_operator">=</span><span class="code_variable">B3</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_function">ode2</span><span class="code_operator">(</span><span class="code_variable">O3lhs</span><span class="code_operator">−</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_function">exponentialize</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O3st</span><span class="code_endofline">,</span> <span class="code_variable">O3rhs</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">x3</span><span class="code_endofline">,</span> <span class="code_variable">T0</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O3sol</span><span class="code_operator">:</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A3</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">B3</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_variable">O3sol</span><span class="code_operator">)</span><span class="code_endofline">$</span> <span class="code_comment">/* We set this to zero for the Method of Reconstitution */</span>  </span></td>
</tr></table>



<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O0123sol</span><span class="code_operator">:</span><span class="code_function">append</span><span class="code_operator">(</span><span class="code_variable">O012sol</span><span class="code_endofline">,</span><span class="code_variable">O3st</span><span class="code_endofline">,</span><span class="code_operator">[</span><span class="code_variable">O3sol</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">$</span>  </span></td>
</tr></table>



<!-- Section cell -->


<div class="section">
<p>
  3 Reconstitution
</p>
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">O1sys</span><span class="code_operator">:</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">taylor</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O0123sol</span><span class="code_endofline">,</span> <span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">ε</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_number">1</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">;</span><span class="code_endofline"><br>
</span><span class="code_variable">O2sys</span><span class="code_operator">:</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">taylor</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O0123sol</span><span class="code_endofline">,</span> <span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">ε</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_number">2</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span><span class="code_endofline"><br>
</span><span class="code_variable">O3sys</span><span class="code_operator">:</span><span class="code_function">expand</span><span class="code_operator">(</span><span class="code_function">factor</span><span class="code_operator">(</span><span class="code_function">taylor</span><span class="code_operator">(</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">O0123sol</span><span class="code_endofline">,</span> <span class="code_function">diff</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_variable">A0</span><span class="code_endofline">,</span><span class="code_variable">B0</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_variable">t</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">ε</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">,</span> <span class="code_number">3</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_operator">)</span><span class="code_endofline">$</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{1sy} \left[ \mathop{-}\left( \ensuremath{\mathrm{B0}} \epsilon \, \ensuremath{\mathrm{\omega 1}}\right) \mathop{-}\ensuremath{\mathrm{A0}} \epsilon  \zeta \, \ensuremath{\mathrm{\omega 0}}\mathop{,}\ensuremath{\mathrm{A0}} \epsilon \, \ensuremath{\mathrm{\omega 1}}\mathop{-}\ensuremath{\mathrm{B0}} \epsilon  \zeta \, \ensuremath{\mathrm{\omega 0}}\mathop{+}\frac{F \epsilon }{2 \ensuremath{\mathrm{\omega 0}}}\right] \]
</p>


<!-- Section cell -->


<div class="section">
<p>
  4 Critical Frequencies for Change in Spiral Orientation (Global Bifurcation)
</p>
</div>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_variable">npars</span><span class="code_operator">:</span><span class="code_operator">[</span><span class="code_variable">ω1</span><span class="code_operator">=</span><span class="code_variable">Ω</span><span class="code_operator">−</span><span class="code_variable">ω0</span><span class="code_endofline">,</span><span class="code_variable">ω2</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">ω3</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">,</span><span class="code_variable">ω0</span><span class="code_operator">=</span><span class="code_number">2</span><span class="code_endofline">,</span><span class="code_variable">ζ</span><span class="code_operator">=</span><span class="code_number">0</span><span class="code_endofline">.</span><span class="code_number">15e-2</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[\tag{par} \left[ \ensuremath{\mathrm{\omega 1}}\mathop{=}\Omega \mathop{-}\ensuremath{\mathrm{\omega 0}}\mathop{,}\ensuremath{\mathrm{\omega 2}}\mathop{=}0\mathop{,}\ensuremath{\mathrm{\omega 3}}\mathop{=}0\mathop{,}\ensuremath{\mathrm{\omega 0}}\mathop{=}2\mathop{,}\zeta \mathop{=}0.0015\right] \]
</p>


<!-- Code cell -->


<table><tr><td>
  <span class="prompt">
 -->	
  </span></td>
  <td><span class="input">
<span class="code_function">wxplot2d</span><span class="code_operator">(</span><span class="code_operator">[</span><span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">npars</span><span class="code_endofline">,</span> <span class="code_variable">J0</span><span class="code_operator">)</span><span class="code_operator">[</span><span class="code_number">2</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_endofline"><br>
</span>        <span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">npars</span><span class="code_endofline">,</span> <span class="code_variable">J0</span><span class="code_operator">+</span><span class="code_variable">J1</span><span class="code_operator">)</span><span class="code_operator">[</span><span class="code_number">2</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_endofline"><br>
</span>        <span class="code_function">subst</span><span class="code_operator">(</span><span class="code_variable">npars</span><span class="code_endofline">,</span> <span class="code_variable">J0</span><span class="code_operator">+</span><span class="code_variable">J1</span><span class="code_operator">+</span><span class="code_variable">J2</span><span class="code_operator">)</span><span class="code_operator">[</span><span class="code_number">2</span><span class="code_endofline">,</span><span class="code_number">1</span><span class="code_operator">]</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_endofline"><br>
</span>        <span class="code_operator">[</span><span class="code_variable">Ω</span><span class="code_endofline">,</span> <span class="code_number">0</span><span class="code_endofline">.</span><span class="code_number">8</span><span class="code_endofline">,</span> <span class="code_number">3</span><span class="code_operator">]</span><span class="code_endofline">,</span> <span class="code_operator">[</span><span class="code_variable">y</span><span class="code_endofline">,</span> <span class="code_operator">−</span><span class="code_number">3</span><span class="code_endofline">,</span> <span class="code_number">2</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_endofline"><br>
</span>        <span class="code_operator">[</span><span class="code_variable">xlabel</span><span class="code_endofline">,</span> <span class="code_string">&quot;Excitation Frequency Ω&quot;</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_endofline"><br>
</span>        <span class="code_operator">[</span><span class="code_variable">ylabel</span><span class="code_endofline">,</span> <span class="code_string">&quot;Jacobian Entry J[2,1]&quot;</span><span class="code_operator">]</span><span class="code_endofline">,</span><span class="code_endofline"><br>
</span>        <span class="code_operator">[</span><span class="code_variable">legend</span><span class="code_endofline">,</span> <span class="code_string">&quot;O(1)&quot;</span><span class="code_endofline">,</span> <span class="code_string">&quot;O(ε)&quot;</span><span class="code_endofline">,</span> <span class="code_string">&quot;O(ε²)&quot;</span><span class="code_operator">]</span><span class="code_operator">)</span><span class="code_endofline">,</span> <span class="code_variable">wxplot_size</span><span class="code_operator">=</span><span class="code_operator">[</span><span class="code_number">500</span><span class="code_endofline">,</span><span class="code_number">400</span><span class="code_operator">]</span><span class="code_endofline">;</span>  </span></td>
</tr></table>
<p>
\[\]\[plot2d: some values will be clipped.\]
</p>
<p>
\[\]\[\tag{%t73} \]
</p>
  <img src="b0_MMS-EMS-rect_linear_htmlimg/b0_MMS-EMS-rect_linear_29.png" width="498" style="max-width:90%;" loading="lazy" alt=" (Graphics) " /><br>

<p>
\[\]\[\tag{%o73} \]
</p>

 <hr>
 <p><small> Created with <a href="https://wxMaxima-developers.github.io/wxmaxima/">wxMaxima</a>.</small></p>
 <small> The source of this Maxima session can be downloaded <a href="b0_MMS-EMS-rect_linear_htmlimg/b0_MMS-EMS-rect_linear.wxmx">here</a>.</small>
 </body>
</html>
